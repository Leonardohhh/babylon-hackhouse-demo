# Sippar
**bring strong finalization to BTC staking for mission critical chains.**

![](logo.png)
## Currently this repo is a demo to do two things:

1. generate a multi-party key shares using FROST algorithm.

2. add a slashing path on Babylon BTC stakingScript that is controlled by the above multi-party keys.


> [!WARNING]
> This is just a demo for Hackathon . Code is not meant to be in any proudction setting. For more information please refer our submission [page](https://dorahacks.io/buidl/19063/milestones) 

### generate a multi-party key shares

```
cd frost/
# generate 3/5 key shares
RUST_LOG=debug cargo run generate

[2024-11-08T03:56:06Z INFO  frost] Taproot address: bc1pdyug6ukgzgpyxtl3kdv4wyjyext638u6saq7ejyp0a0mljdlkgtsdke3vx

==>  corresonding key shares are output in my_map.json

# verify checks
RUST_LOG=debug cargo run verify
[2024-11-08T03:58:55Z INFO  frost] Group signature: "022f77348c6d63a1b918954d6303a37f6cbd511a332f41f7ac8fca585a45aa420f464dd3c65036a6983d76e958873194010974df9bfd0281b4d5f04303bf0da0c5"
[2024-11-08T03:58:55Z INFO  frost] Signature valid: true
```

### create a staking tx with the added path
```
cd staking-ts/
node main.js

# create a staking script WITH the validator MPC path
staker taproot address:  tb1pwzdt554fhylw22ujlc2pekpwtwnpj370whskaecnwz8mpqpl9ffqqmjddt
Validator MPC public key:  a87edc864cd5160b489539bbf289a30eac12043668c1078ef074f91f74c8ac32
Transaction:  02000000....38c0d300000000


# create a staking script WITH the validator MPC path
staker taproot address:  tb1pwzdt554fhylw22ujlc2pekpwtwnpj370whskaecnwz8mpqpl9ffqqmjddt
No validator MPC public key
Transaction:  020000000001012a......2bd382200000000

```

Under the hook, we added an additional path over the staking script

https://github.com/Leonardohhh/babylon-hackhouse-demo/blob/510e0c882c2bffc5442e88ed839de7268c42f8af/staking-ts/src/index.ts#L56-L63

If this validatorMpcKey is left emptied, it would be the same as a normal staking tx.

## Why
Babylon creates a BTC staking platform where a pubkey owner (finalization provider) is confined from double-signing. This guarantee leads to finalization guarantee. 

However, for practical reasons, for mission-critical operations like cross-chain swap, or bridges, the fp cannot be trusted in this setup, since they can just cheat to benefit from a wrong finalisation, and then simply disappear. The btc stakers (collider or innocent delegator) can still unbond their btc. 

```
We believe there needs to be a stonger form of finalization.
```

One implementation is to add an option for some of the staker to commit their bitcoin to social slashing, a pubkey generated by consumer's PoS validators through threshold encryption. This allows these stakers to finalize for more important blocks and create skin-in-the-game for those finalization.

Threshold encryption enables the active validators to refresh their key shares. This can solve the on-going update of active validator sets. There is some risk of malicious ex-validator colliding with existing validators by [using their previous copy]((https://frost.zfnd.org/frost.html#admonition-danger)). This risk of colliding can be controlled based on an epoch based rotation regarding the generated pubkey.


## Further Research
We intend to leverage the FROST threshold signature to enable this new taproot script, the slashing has to be agreed by more than 2/3 of consumer's validators set. In the future, some attestation mechanism can be added to the new taproot path by leveraging bitVM's ZKsnark technology

